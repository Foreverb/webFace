{"ast":null,"code":"import _classCallCheck from \"D:\\\\webFace\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\webFace\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"D:\\\\webFace\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"D:\\\\webFace\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"D:\\\\webFace\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"D:\\\\webFace\\\\src\\\\Components\\\\rightBottom.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n//右下发送消息区域\nimport React, { Component } from 'react';\nimport '../css/rightBottom.css';\nimport ChatClient from '../ChatClient';\nimport FileUpload from '../fileUpload';\nimport Emjoi from './emjoi';\n\nvar RightBottom = /*#__PURE__*/function (_Component) {\n  _inherits(RightBottom, _Component);\n\n  var _super = _createSuper(RightBottom);\n\n  function RightBottom(props) {\n    var _this;\n\n    _classCallCheck(this, RightBottom);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      cls_icon: ['iconCard'],\n      isClick: true\n    };\n    return _this;\n  }\n\n  _createClass(RightBottom, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          cls_icon = _this$state.cls_icon,\n          isClick = _this$state.isClick;\n      var _this$props = this.props,\n          chatModePid = _this$props.chatModePid,\n          profile = _this$props.profile,\n          uploadFile = _this$props.uploadFile;\n      var id = profile.id,\n          ava = profile.ava;\n      var socket = ChatClient.socket;\n      cls_icon = cls_icon.join(' ');\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"rightBottom\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 22,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"statusCard\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 23,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"emjoi\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 24,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"point\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 25,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"img\", {\n        src: \"https://raw.githubusercontent.com/Foreverb/foreverb.github.io/master/img/emjoi.png\",\n        className: \"Emjoi\",\n        alt: \"\",\n        onClick: function onClick() {\n          return _this2.showEmjoi();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 26,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: cls_icon,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 27,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Emjoi, {\n        closeEmjoi: function closeEmjoi(data) {\n          return _this2.closeEmjoi(data);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 27,\n          columnNumber: 39\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"file\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 29,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"https://raw.githubusercontent.com/Foreverb/foreverb.github.io/master/img/file.png\",\n        className: \"File\",\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 30,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"form\", {\n        encType: \"multipart/form-data\",\n        id: \"fileIpt\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 31,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"file\",\n        className: \"fileBtn\",\n        required: true,\n        name: \"thumbnail\",\n        onClick: function onClick(e) {\n          _this2.uploadFile(e.target, id, chatModePid, socket, profile, uploadFile);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 32,\n          columnNumber: 15\n        }\n      }))), chatModePid !== -1 ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"rtc\",\n        onClick: function onClick() {\n          _this2.startRtc();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 34\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"https://www.easyicon.net/api/resizeApi.php?id=1136097&size=128\",\n        className: \"Rtc\",\n        alt: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 15\n        }\n      })) : null), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"input\",\n        onClick: function onClick(e) {\n          _this2.startSendMsg(e);\n        },\n        onKeyDown: function onKeyDown(e) {\n          e.keyCode === 13 && _this2._enterSend(e);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"send\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"tip\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 44,\n          columnNumber: 11\n        }\n      }, \"\\u6309\\u4E0B Ctrl + Enter \\u6362\\u884C \"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"btn\",\n        onClick: function onClick() {\n          return _this2._startSend();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 11\n        }\n      }, \"\\u53D1\\u9001\")));\n    } //根据isClick判断emjio是否显示\n\n  }, {\n    key: \"judgeEmjoiShowOrClose\",\n    value: function judgeEmjoiShowOrClose() {\n      if (this.state.isClick) {\n        this.setState({\n          cls_icon: ['iconCard', 'show']\n        });\n      } else {\n        this.setState({\n          cls_icon: ['iconCard']\n        });\n      }\n    } //打开emjio\n\n  }, {\n    key: \"showEmjoi\",\n    value: function showEmjoi() {\n      this.setState({\n        isClick: !this.state.isClick\n      });\n      this.judgeEmjoiShowOrClose();\n    } //关闭emjio\n\n  }, {\n    key: \"closeEmjoi\",\n    value: function closeEmjoi(state) {\n      this.setState({\n        isClick: state\n      });\n      this.judgeEmjoiShowOrClose();\n    }\n  }, {\n    key: \"uploadFile\",\n    value: function uploadFile(This, id, chatModePid, socket, profile, _uploadFile) {\n      FileUpload.uploadImage(This, id, chatModePid, socket, profile, _uploadFile);\n    } //发送消息\n\n  }, {\n    key: \"startSendMsg\",\n    value: function startSendMsg(e) {\n      e.target.setAttribute('contenteditable', true); // if( e.target.innerText!=='' ){\n      //   ChatClient.setCaretPosition(e.target,e.target.innerText.length);\n      // }\n\n      e.target.focus();\n    }\n  }, {\n    key: \"_startSend\",\n    value: function _startSend() {\n      var onSendMsg = this.props.onSendMsg;\n      var input = document.getElementsByClassName('input')[0]; // console.log(input);\n\n      var msg = input.innerText;\n      onSendMsg && onSendMsg(msg);\n      input.innerText = '';\n    }\n  }, {\n    key: \"_enterSend\",\n    value: function _enterSend(e) {\n      e.cancelBubble = true;\n      e.preventDefault();\n\n      this._startSend();\n    }\n  }, {\n    key: \"startRtc\",\n    value: function startRtc() {\n      var _this$props2 = this.props,\n          chatModePid = _this$props2.chatModePid,\n          profile = _this$props2.profile,\n          uploadFile = _this$props2.uploadFile,\n          startRtc = _this$props2.startRtc;\n      var id = profile.id;\n      var socket = ChatClient.socket;\n      var that = this;\n      var content = JSON.stringify({\n        content: profile,\n        from: id,\n        to: chatModePid,\n        type: 'videoRquest'\n      });\n      socket.send(content);\n      startRtc && startRtc();\n      ChatClient.start(function () {\n        console.log('发起方添加视频流', ChatClient.localStream);\n        ChatClient.pc.addStream(ChatClient.localStream);\n\n        ChatClient.pc.onaddstream = function (event) {\n          //接收offer方的视频流，并显示出来\n          console.log(\"Received remote stream\");\n          var stream = event.stream; // debugger\n          //显示对方视频流\n\n          console.log('显示接收方视频流', stream);\n          var remoteVideo = document.getElementsByClassName('remoteVideo')[0]; // let remoteVideo = ChatClient.remoteRef.current;\n\n          remoteVideo.srcObject = stream;\n        };\n      });\n    }\n  }]);\n\n  return RightBottom;\n}(Component);\n\nexport default RightBottom;","map":{"version":3,"sources":["D:/webFace/src/Components/rightBottom.js"],"names":["React","Component","ChatClient","FileUpload","Emjoi","RightBottom","props","state","cls_icon","isClick","chatModePid","profile","uploadFile","id","ava","socket","join","showEmjoi","data","closeEmjoi","e","target","startRtc","startSendMsg","keyCode","_enterSend","_startSend","setState","judgeEmjoiShowOrClose","This","uploadImage","setAttribute","focus","onSendMsg","input","document","getElementsByClassName","msg","innerText","cancelBubble","preventDefault","that","content","JSON","stringify","from","to","type","send","start","console","log","localStream","pc","addStream","onaddstream","event","stream","remoteVideo","srcObject"],"mappings":"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","sourcesContent":["//右下发送消息区域\r\nimport React, { Component } from 'react';\r\nimport '../css/rightBottom.css';\r\nimport ChatClient from '../ChatClient';\r\nimport FileUpload from '../fileUpload';\r\nimport Emjoi from './emjoi';\r\nclass RightBottom extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      cls_icon: ['iconCard'],\r\n      isClick: true,\r\n    }\r\n  }\r\n  render() {\r\n    let { cls_icon, isClick } = this.state;\r\n    let { chatModePid, profile, uploadFile } = this.props;\r\n    let { id, ava } = profile;\r\n    let socket = ChatClient.socket;\r\n    cls_icon = cls_icon.join(' ');\r\n    return (\r\n      <div className='rightBottom'>\r\n        <div className='statusCard'>\r\n          <div className='emjoi'>\r\n            <div className=\"point\"></div>\r\n            <img src='https://raw.githubusercontent.com/Foreverb/foreverb.github.io/master/img/emjoi.png' className='Emjoi' alt='' onClick={() => this.showEmjoi()} />\r\n            <div className={cls_icon}><Emjoi closeEmjoi={(data) => this.closeEmjoi(data)} /></div>\r\n          </div>\r\n          <div className='file'>\r\n            <img src='https://raw.githubusercontent.com/Foreverb/foreverb.github.io/master/img/file.png' className='File' alt='' />\r\n            <form encType=\"multipart/form-data\" id='fileIpt'>\r\n              <input type='file' className='fileBtn' required name=\"thumbnail\" onClick={(e) => { this.uploadFile(e.target, id, chatModePid, socket, profile, uploadFile) }} />\r\n            </form>\r\n          </div>\r\n          {\r\n            chatModePid !== -1 ? <div className='rtc' onClick={() => { this.startRtc() }}>\r\n              <img src='https://www.easyicon.net/api/resizeApi.php?id=1136097&size=128' className='Rtc' alt='' />\r\n            </div> : null\r\n          }\r\n        </div>\r\n        <div className='input' onClick={(e) => { this.startSendMsg(e) }}\r\n          onKeyDown={(e) => { e.keyCode === 13 && this._enterSend(e) }}></div>\r\n        <div className='send'>\r\n          <p className='tip'>按下 Ctrl + Enter 换行 </p>\r\n          <button className='btn' onClick={() => this._startSend()}>发送</button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n  //根据isClick判断emjio是否显示\r\n  judgeEmjoiShowOrClose() {\r\n    if (this.state.isClick) {\r\n      this.setState({ cls_icon: ['iconCard', 'show'] })\r\n    } else {\r\n      this.setState({ cls_icon: ['iconCard'] })\r\n    }\r\n  }\r\n  //打开emjio\r\n  showEmjoi() {\r\n    this.setState({ isClick: !this.state.isClick })\r\n    this.judgeEmjoiShowOrClose()\r\n  }\r\n  //关闭emjio\r\n  closeEmjoi(state) {\r\n    this.setState({ isClick: state })\r\n    this.judgeEmjoiShowOrClose()\r\n  }\r\n  uploadFile(This, id, chatModePid, socket, profile, uploadFile) {\r\n    FileUpload.uploadImage(This, id, chatModePid, socket, profile, uploadFile)\r\n  }\r\n  //发送消息\r\n  startSendMsg(e) {\r\n    e.target.setAttribute('contenteditable', true);\r\n    // if( e.target.innerText!=='' ){\r\n    //   ChatClient.setCaretPosition(e.target,e.target.innerText.length);\r\n    // }\r\n    e.target.focus();\r\n  }\r\n  _startSend() {\r\n    let { onSendMsg } = this.props;\r\n    let input = document.getElementsByClassName('input')[0];\r\n    // console.log(input);\r\n    let msg = input.innerText;\r\n    onSendMsg && onSendMsg(msg);\r\n    input.innerText = '';\r\n  }\r\n  _enterSend(e) {\r\n    e.cancelBubble = true;\r\n    e.preventDefault();\r\n    this._startSend();\r\n  }\r\n  startRtc() {\r\n    let { chatModePid, profile, uploadFile, startRtc } = this.props;\r\n    let { id } = profile;\r\n    let socket = ChatClient.socket;\r\n    let that = this;\r\n    let content = JSON.stringify({ content: profile, from: id, to: chatModePid, type: 'videoRquest' });\r\n    socket.send(content);\r\n    startRtc && startRtc();\r\n\r\n    ChatClient.start(function () {\r\n      console.log('发起方添加视频流', ChatClient.localStream);\r\n      ChatClient.pc.addStream(ChatClient.localStream);\r\n      ChatClient.pc.onaddstream = (event) => {\r\n        //接收offer方的视频流，并显示出来\r\n\r\n        console.log(\"Received remote stream\");\r\n\r\n        let stream = event.stream;\r\n        // debugger\r\n        //显示对方视频流\r\n        console.log('显示接收方视频流', stream)\r\n        let remoteVideo = document.getElementsByClassName('remoteVideo')[0];\r\n        // let remoteVideo = ChatClient.remoteRef.current;\r\n        remoteVideo.srcObject = stream;\r\n      };\r\n    })\r\n  }\r\n}\r\nexport default RightBottom;\r\n"]},"metadata":{},"sourceType":"module"}