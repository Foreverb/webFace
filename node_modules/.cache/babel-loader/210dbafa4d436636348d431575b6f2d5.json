{"ast":null,"code":"import _classCallCheck from \"D:\\\\webFace\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\webFace\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\n\nvar FileUpload = /*#__PURE__*/function () {\n  function FileUpload() {\n    _classCallCheck(this, FileUpload);\n  }\n\n  _createClass(FileUpload, [{\n    key: \"uploadImage\",\n    value: //上传图片\n    function uploadImage(El, from, to, socket, profile, uploadFile) {\n      var ava = profile.ava;\n\n      El.onchange = function (e) {\n        var oData = new FormData();\n        oData.append('thumbnail', e.target.files[0]); // debugger\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", \"https://140.82.16.201:19999/upload\", true);\n        xhr.send(oData);\n\n        xhr.onload = function (oEvent) {\n          if (xhr.status == 200 && xhr.readyState == 4) {\n            console.log(xhr.responseText);\n            uploadFile(xhr.responseText);\n            var data = JSON.stringify({\n              date: {\n                content: xhr.responseText,\n                src: ava\n              },\n              from: from,\n              to: to,\n              type: 'chatMessage'\n            });\n            socket.send(data);\n          }\n        };\n      };\n    }\n  }, {\n    key: \"upgradeAva\",\n    value: //更新头像\n    function upgradeAva(El, from, to, socket, profile, updateAvatar) {\n      El.onchange = function (e) {\n        var oData = new FormData();\n        oData.append('thumbnail', e.target.files[0]); // debugger\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", \"https://140.82.16.201:19999/upload\", true);\n        xhr.send(oData);\n\n        xhr.onload = function (oEvent) {\n          if (xhr.status == 200 && xhr.readyState == 4) {\n            updateAvatar(xhr.responseText);\n          }\n        };\n      };\n    }\n  }]);\n\n  return FileUpload;\n}();\n\nexport default new FileUpload();","map":{"version":3,"sources":["D:/webFace/src/fileUpload.js"],"names":["FileUpload","El","from","to","socket","profile","uploadFile","ava","onchange","e","oData","FormData","append","target","files","xhr","XMLHttpRequest","open","send","onload","oEvent","status","readyState","console","log","responseText","data","JSON","stringify","date","content","src","type","updateAvatar"],"mappings":";;;IAAMA,U;;;;;;;WACJ;AACA,yBAAYC,EAAZ,EAAeC,IAAf,EAAoBC,EAApB,EAAuBC,MAAvB,EAA8BC,OAA9B,EAAsCC,UAAtC,EAAiD;AAAA,UAC1CC,GAD0C,GACnCF,OADmC,CAC1CE,GAD0C;;AAE/CN,MAAAA,EAAE,CAACO,QAAH,GAAc,UAASC,CAAT,EAAW;AACvB,YAAIC,KAAK,GAAG,IAAIC,QAAJ,EAAZ;AACAD,QAAAA,KAAK,CAACE,MAAN,CAAa,WAAb,EAAyBH,CAAC,CAACI,MAAF,CAASC,KAAT,CAAe,CAAf,CAAzB,EAFuB,CAGvB;;AACA,YAAIC,GAAG,GAAG,IAAIC,cAAJ,EAAV;AACAD,QAAAA,GAAG,CAACE,IAAJ,CAAS,MAAT,EAAiB,oCAAjB,EAAuD,IAAvD;AACAF,QAAAA,GAAG,CAACG,IAAJ,CAASR,KAAT;;AACAK,QAAAA,GAAG,CAACI,MAAJ,GAAa,UAAUC,MAAV,EAAkB;AAC3B,cAAIL,GAAG,CAACM,MAAJ,IAAc,GAAd,IAAqBN,GAAG,CAACO,UAAJ,IAAkB,CAA3C,EAA8C;AAC5CC,YAAAA,OAAO,CAACC,GAAR,CAAYT,GAAG,CAACU,YAAhB;AACAnB,YAAAA,UAAU,CAACS,GAAG,CAACU,YAAL,CAAV;AACA,gBAAIC,IAAI,GAAGC,IAAI,CAACC,SAAL,CAAe;AAACC,cAAAA,IAAI,EAAC;AAACC,gBAAAA,OAAO,EAACf,GAAG,CAACU,YAAb;AAA0BM,gBAAAA,GAAG,EAACxB;AAA9B,eAAN;AAAyCL,cAAAA,IAAI,EAACA,IAA9C;AAAmDC,cAAAA,EAAE,EAACA,EAAtD;AAAyD6B,cAAAA,IAAI,EAAC;AAA9D,aAAf,CAAX;AACA5B,YAAAA,MAAM,CAACc,IAAP,CAAYQ,IAAZ;AACD;AACJ,SAPD;AAQD,OAfD;AAgBD;;;WACD;AACA,wBAAWzB,EAAX,EAAcC,IAAd,EAAmBC,EAAnB,EAAsBC,MAAtB,EAA6BC,OAA7B,EAAqC4B,YAArC,EAAkD;AAChDhC,MAAAA,EAAE,CAACO,QAAH,GAAc,UAASC,CAAT,EAAW;AACvB,YAAIC,KAAK,GAAG,IAAIC,QAAJ,EAAZ;AACAD,QAAAA,KAAK,CAACE,MAAN,CAAa,WAAb,EAAyBH,CAAC,CAACI,MAAF,CAASC,KAAT,CAAe,CAAf,CAAzB,EAFuB,CAGvB;;AACA,YAAIC,GAAG,GAAG,IAAIC,cAAJ,EAAV;AACAD,QAAAA,GAAG,CAACE,IAAJ,CAAS,MAAT,EAAiB,oCAAjB,EAAuD,IAAvD;AACAF,QAAAA,GAAG,CAACG,IAAJ,CAASR,KAAT;;AACAK,QAAAA,GAAG,CAACI,MAAJ,GAAa,UAAUC,MAAV,EAAkB;AAC3B,cAAIL,GAAG,CAACM,MAAJ,IAAc,GAAd,IAAqBN,GAAG,CAACO,UAAJ,IAAkB,CAA3C,EAA8C;AAC5CW,YAAAA,YAAY,CAAClB,GAAG,CAACU,YAAL,CAAZ;AACD;AACJ,SAJD;AAKD,OAZD;AAaD;;;;;;AAEH,eAAe,IAAIzB,UAAJ,EAAf","sourcesContent":["class FileUpload{\r\n  //上传图片\r\n  uploadImage(El,from,to,socket,profile,uploadFile){\r\n    let {ava} = profile;\r\n    El.onchange = function(e){\r\n      let oData = new FormData();\r\n      oData.append('thumbnail',e.target.files[0]);\r\n      // debugger\r\n      let xhr = new XMLHttpRequest();\r\n      xhr.open(\"POST\", \"https://140.82.16.201:19999/upload\", true);\r\n      xhr.send(oData);\r\n      xhr.onload = function (oEvent) {\r\n          if (xhr.status == 200 && xhr.readyState == 4) {\r\n            console.log(xhr.responseText);\r\n            uploadFile(xhr.responseText)\r\n            let data = JSON.stringify({date:{content:xhr.responseText,src:ava},from:from,to:to,type:'chatMessage'})\r\n            socket.send(data);\r\n          }\r\n      };\r\n    }\r\n  };\r\n  //更新头像\r\n  upgradeAva(El,from,to,socket,profile,updateAvatar){\r\n    El.onchange = function(e){\r\n      let oData = new FormData();\r\n      oData.append('thumbnail',e.target.files[0]);\r\n      // debugger\r\n      let xhr = new XMLHttpRequest();\r\n      xhr.open(\"POST\", \"https://140.82.16.201:19999/upload\", true);\r\n      xhr.send(oData);\r\n      xhr.onload = function (oEvent) {\r\n          if (xhr.status == 200 && xhr.readyState == 4) {\r\n            updateAvatar(xhr.responseText)\r\n          }\r\n      };\r\n    }\r\n  };\r\n}\r\nexport default new FileUpload();\r\n"]},"metadata":{},"sourceType":"module"}